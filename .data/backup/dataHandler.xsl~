<?xml version="1.0" encoding="UTF-8"?>
<!--#################################################################################################### ##-->
<!--## 	          Property of United Airlines                                            				 ##-->
<!--##	          Copyright (c) United Airlines. All Rights Reserved.                    				 ##-->
<!--##                                                                                   				 ##-->
<!--## Author         :                                                                 				 ##-->
<!--## File           : dataHandler.xsl                                           				         ##-->
<!--## Information    : OAuth Token Customization                                        				 ##-->
<!--## Version        : 1.0                                                              				 ##-->
<!--## Release Notes  : Version 1.0 is the Initial commit                                				 ##-->
<!--##                                                                                   				 ##-->
<!--## Description    : This XSLT transforms the JSON request payload to an xml data structure           ##-->
<!--##                                                                                  				 ##-->
<!--#################################################################################################### ##-->
<xsl:stylesheet version="2.0" xsi:schemaLocation="http://www.datapower.com/schemas/json jsonx.xsd"
							  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
							  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
							  xmlns:dp="http://www.datapower.com/extensions"
							  xmlns:json="http://www.ibm.com/xmlns/prod/2009/jsonx"
							  extension-element-prefixes="dp json xsi"
							  exclude-result-prefixes="dp json xsi">
	<xsl:output method="xml" version="1.0" encoding="UTF-8" indent="yes" omit-xml-declaration="yes"/>
	<xsl:strip-space elements="*"/>

	<!-- Matching Template Element: root -->
	<xsl:template match="/">
		<xsl:variable name="inbound_content_type" select="dp:variable('var://service/original-content-type')"/>
		<xsl:variable name="reqTransform" select="'jsonx2form.xslt'"/>
		<xsl:choose>
			<xsl:when test="contains($inbound_content_type,'json')">
				<xsl:copy-of select="dp:transform($reqTransform, .)"/>
			</xsl:when>
			<xsl:otherwise>
				<xsl:copy-of select="."/>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
</xsl:stylesheet>
